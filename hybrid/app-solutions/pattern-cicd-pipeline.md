---
title: Azure Stack Hub の DevOps パターン
description: DevOps パターンについて学習することで、Azure とAzure Stack Hub でのデプロイ間の一貫性を確保することができます。
author: BryanLa
ms.topic: article
ms.date: 11/05/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 11/05/2019
ms.openlocfilehash: 306cc9604a8e919724f9f76b7e5122d534d2d1ae
ms.sourcegitcommit: bb3e40b210f86173568a47ba18c3cc50d4a40607
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/17/2020
ms.locfileid: "84911119"
---
# <a name="devops-pattern"></a><span data-ttu-id="0c3d9-103">DevOps パターン</span><span class="sxs-lookup"><span data-stu-id="0c3d9-103">DevOps pattern</span></span>

<span data-ttu-id="0c3d9-104">1 つの場所からコードを作成して、ローカル データセンター、プライベート クラウド、またはパブリック クラウドに存在する可能性がある開発環境、テスト環境、運用環境内の複数のターゲットにデプロイします。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-104">Code from a single location and deploy to multiple targets in development, test, and production environments that may be in your local datacenter, private clouds, or the public cloud.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="0c3d9-105">コンテキストと問題</span><span class="sxs-lookup"><span data-stu-id="0c3d9-105">Context and problem</span></span>

<span data-ttu-id="0c3d9-106">アプリケーション デプロイの継続性、セキュリティ、および信頼性は、組織にとって非常に重要であり、開発チームにも欠かせません。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-106">Application deployment continuity, security, and reliability are essential to organizations and critical to development teams.</span></span>

<span data-ttu-id="0c3d9-107">アプリでは、多くの場合、ターゲット環境ごとにリファクタリングされたコードを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-107">Apps often require refactored code to run in each target environment.</span></span> <span data-ttu-id="0c3d9-108">これは、アプリが完全に移植可能ではないことを意味します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-108">This means that an app isn't completely portable.</span></span> <span data-ttu-id="0c3d9-109">環境が変わるたびに更新、テスト、および検証を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-109">It must be updated, tested, and validated as it moves through each environment.</span></span> <span data-ttu-id="0c3d9-110">たとえば、開発環境で記述したコードは、テスト環境で動作するように書き直す必要があり、最終的に運用環境に配置するときにも書き直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-110">For example, code written in a development environment must then be rewritten to work in a test environment and rewritten when it finally lands in a production environment.</span></span> <span data-ttu-id="0c3d9-111">さらに、このコードは特にホストに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-111">Furthermore, this code is specifically tied to the host.</span></span> <span data-ttu-id="0c3d9-112">これにより、アプリの保守のコストと複雑さが増加します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-112">This increases the cost and complexity of maintaining your app.</span></span> <span data-ttu-id="0c3d9-113">アプリの各バージョンは、各環境に関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-113">Each version of the app is tied to each environment.</span></span> <span data-ttu-id="0c3d9-114">複雑さと重複が増加すると、セキュリティとコード品質のリスクが高まります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-114">The increased complexity and duplication increase the risk of security and code quality.</span></span> <span data-ttu-id="0c3d9-115">また、復元に失敗したホストを削除したり、需要の増加に対応するために追加のホストをデプロイしたりするときに、コードを簡単に再デプロイできません。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-115">In addition, the code can't be readily redeployed when you remove restore failed hosts or deploy additional hosts to handle increases in demand.</span></span>

## <a name="solution"></a><span data-ttu-id="0c3d9-116">解決策</span><span class="sxs-lookup"><span data-stu-id="0c3d9-116">Solution</span></span>

<span data-ttu-id="0c3d9-117">DevOps パターンを使用すると、複数のクラウドで実行されるアプリをビルド、テスト、およびデプロイできます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-117">The DevOps Pattern enables you to build, test, and deploy an app that runs on multiple clouds.</span></span> <span data-ttu-id="0c3d9-118">このパターンは、継続的インテグレーションと継続的デリバリーのプラクティスを統合したものです。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-118">This pattern unites the practice of continuous integration and continuous delivery.</span></span> <span data-ttu-id="0c3d9-119">継続的インテグレーションにより、チーム メンバーがバージョン コントロールに変更をコミットするたびにコードがビルドおよびテストされます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-119">With continuous integration, code is built and tested every time a team member commits a change to version control.</span></span> <span data-ttu-id="0c3d9-120">継続的デリバリーでは、ビルドから運用環境までの各手順が自動化されます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-120">Continuous delivery automates each step from a build to a production environment.</span></span> <span data-ttu-id="0c3d9-121">これらのプロセスが合わさって、多様な環境にまたがったデプロイをサポートするリリース プロセスになります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-121">Together, these processes create a release process that supports deployment across diverse environments.</span></span> <span data-ttu-id="0c3d9-122">このパターンでは、コードのドラフトを記述して、同じコードを構内環境、さまざまなプライベート クラウド、およびパブリック クラウドにデプロイできます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-122">With this pattern, you can draft your code and then deploy the same code to a premise environment, different private clouds, and the public clouds.</span></span> <span data-ttu-id="0c3d9-123">環境の違いに合わせて、コードを変更するのではなく構成ファイルを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-123">Differences in environment require a change to a configuration file rather than changes to the code.</span></span>

![DevOps パターン](media/pattern-cicd-pipeline/hybrid-ci-cd.png)

<span data-ttu-id="0c3d9-125">オンプレミス、プライベート クラウド、パブリック クラウドの各環境にわたって一貫した開発ツールのセットを使用して、継続的インテグレーションと継続的デリバリーのプラクティスを実装することができます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-125">With a consistent set of development tools across on-premises, private cloud, and public cloud environments, you can implement a practice of continuous integration and continuous delivery.</span></span> <span data-ttu-id="0c3d9-126">DevOps パターンを使用してデプロイしたアプリとサービスは、交換可能で、これらの場所のどこでも実行でき、オンプレミスとパブリック クラウドの機能を活用できます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-126">Apps and services deployed using the DevOps Pattern are interchangeable and can run in any of these locations, taking advantage of on-premises and public cloud features and capabilities.</span></span>

<span data-ttu-id="0c3d9-127">DevOps リリース パイプラインを使用すると、次のことができます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-127">Using a DevOps release pipeline helps you:</span></span>

- <span data-ttu-id="0c3d9-128">単一リポジトリへのコード コミットに基づいて、新しいビルドを開始します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-128">Initiate a new build based on code commits to a single repository.</span></span>
- <span data-ttu-id="0c3d9-129">ユーザー受け入れテストのため、新しくビルドされたコードをパブリック クラウドに自動的にデプロイします。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-129">Automatically deploy your newly built code to the public cloud for user acceptance testing.</span></span>
- <span data-ttu-id="0c3d9-130">コードがテストに合格したら、自動的にプライベート クラウドにデプロイします。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-130">Automatically deploy to a private cloud once your code has passed testing.</span></span>

## <a name="issues-and-considerations"></a><span data-ttu-id="0c3d9-131">問題と注意事項</span><span class="sxs-lookup"><span data-stu-id="0c3d9-131">Issues and considerations</span></span>

<span data-ttu-id="0c3d9-132">DevOps パターンは、ターゲット環境に関係なく、デプロイ間の一貫性を確保することを目的としています。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-132">The DevOps Pattern is intended to ensure consistency across deployments regardless of the target environment.</span></span> <span data-ttu-id="0c3d9-133">ただし、機能は、クラウド環境とオンプレミス環境で異なります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-133">However, capabilities vary across cloud and on-premises environments.</span></span> <span data-ttu-id="0c3d9-134">次の点を考慮してください。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-134">Consider the following points:</span></span>

- <span data-ttu-id="0c3d9-135">デプロイ内の関数、エンドポイント、サービス、その他のリソースはデプロイ先の場所で利用できますか?</span><span class="sxs-lookup"><span data-stu-id="0c3d9-135">Are the functions, endpoints, services, and other resources in your deployment available in the target deployment locations?</span></span>
- <span data-ttu-id="0c3d9-136">構成成果物は、クラウドをまたいでアクセスできる場所に格納されていますか?</span><span class="sxs-lookup"><span data-stu-id="0c3d9-136">Are configuration artifacts stored in locations that are accessible across clouds?</span></span>
- <span data-ttu-id="0c3d9-137">デプロイ パラメーターはすべてのターゲット環境で機能しますか?</span><span class="sxs-lookup"><span data-stu-id="0c3d9-137">Will deployment parameters work in all the target environments?</span></span>
- <span data-ttu-id="0c3d9-138">リソース固有のプロパティはすべてのターゲット クラウドで使用できますか?</span><span class="sxs-lookup"><span data-stu-id="0c3d9-138">Are resource-specific properties available in all target clouds?</span></span>

<span data-ttu-id="0c3d9-139">詳細については、「[クラウドの一貫性のための Azure Resource Manager テンプレートを開発する](https://docs.microsoft.com/azure/azure-resource-manager/templates-cloud-consistency)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-139">For more information, see [Develop Azure Resource Manager templates for cloud consistency](https://docs.microsoft.com/azure/azure-resource-manager/templates-cloud-consistency).</span></span>

<span data-ttu-id="0c3d9-140">また、このパターンの実装方法を決めるときには、以下の点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-140">In addition, consider the following points when deciding how to implement this pattern:</span></span>

### <a name="scalability"></a><span data-ttu-id="0c3d9-141">スケーラビリティ</span><span class="sxs-lookup"><span data-stu-id="0c3d9-141">Scalability</span></span>

<span data-ttu-id="0c3d9-142">デプロイ自動化システムは、DevOps パターンの主要な制御ポイントです。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-142">Deployment automation systems are the key control point in the DevOps Patterns.</span></span> <span data-ttu-id="0c3d9-143">実装は異なる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-143">Implementations can vary.</span></span> <span data-ttu-id="0c3d9-144">適切なサーバー サイズの選択は、予想されるワークロードのサイズによって異なります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-144">The selection of the correct server size depends on the size of the expected workload.</span></span> <span data-ttu-id="0c3d9-145">VM の方がコンテナーよりスケーリングのコストが高くなります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-145">VMs cost more to scale than containers.</span></span> <span data-ttu-id="0c3d9-146">ただし、スケーリングのためにコンテナーを使用するには、コンテナーでビルド プロセスを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-146">To use containers for scaling, however, your build process must run with containers.</span></span>

### <a name="availability"></a><span data-ttu-id="0c3d9-147">可用性</span><span class="sxs-lookup"><span data-stu-id="0c3d9-147">Availability</span></span>

<span data-ttu-id="0c3d9-148">DevPattern のコンテキストにおける可用性とは、ワークフローに関連付けられているすべての状態情報 (テスト結果など)、コードの依存関係、または他の成果物を復旧できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-148">Availability in the context of the DevPattern means being able to recover any state information associated with your workflow, such as test results, code dependencies, or other artifacts.</span></span> <span data-ttu-id="0c3d9-149">可用性の要件を評価するには、次の 2 つの一般的なメトリックを検討します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-149">To assess your availability requirements, consider two common metrics:</span></span>

- <span data-ttu-id="0c3d9-150">目標復旧時間 (RTO) は、システムなしで継続できる時間を示します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-150">Recovery Time Objective (RTO) specifies how long you can go without a system.</span></span>

- <span data-ttu-id="0c3d9-151">目標復旧時点 (RPO) は、サービスの中断がシステムに影響を及ぼす場合に、失われても差し支えないデータの量を示します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-151">Recovery Point Objective (RPO) indicates how much data you can afford to lose if a disruption in service affects the system.</span></span>

<span data-ttu-id="0c3d9-152">実際には、RTO と RPO は冗長性とバックアップを意味します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-152">In practice, RTO, and RPO imply redundancy and backup.</span></span> <span data-ttu-id="0c3d9-153">グローバル Azure クラウドでは、可用性は、Azure の一部であるハードウェアの復旧の問題ではなく、DevOps システムの状態を確実に維持することを表します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-153">On the global Azure cloud, availability isn't a question of hardware recovery—that's part of Azure—but rather ensuring you maintain the state of your DevOps systems.</span></span> <span data-ttu-id="0c3d9-154">Azure Stack Hub では、ハードウェアの復旧について考慮することが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-154">On Azure Stack Hub, hardware recovery may be a consideration.</span></span>

<span data-ttu-id="0c3d9-155">デプロイの自動化に使用されるシステムを設計する際のもう 1 つの重要な考慮事項は、アクセス制御と、クラウド環境へのサービスのデプロイに必要な権限の適切な管理です。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-155">Another major consideration when designing the system used for deployment automation is access control and the proper management of the rights needed to deploy services to cloud environments.</span></span> <span data-ttu-id="0c3d9-156">デプロイを作成、削除、または変更するには、どのような権限が必要ですか?</span><span class="sxs-lookup"><span data-stu-id="0c3d9-156">What rights are needed to create, delete, or modify deployments?</span></span> <span data-ttu-id="0c3d9-157">たとえば、通常、Azure でリソース グループを作成するために必要な権限のセットと、リソース グループにサービスをデプロイするために必要な権限のセットは別のものです。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-157">For example, one set of rights is typically required to create a resource group in Azure and another to deploy services in the resource group.</span></span>

### <a name="manageability"></a><span data-ttu-id="0c3d9-158">管理の容易性</span><span class="sxs-lookup"><span data-stu-id="0c3d9-158">Manageability</span></span>

<span data-ttu-id="0c3d9-159">DevOps パターンに基づいたシステムの設計では、各サービスの自動化、ログ記録、アラートをポートフォリオ全体で考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-159">The design of any system based on the DevOps pattern must consider automation, logging, and alerting for each service across the portfolio.</span></span> <span data-ttu-id="0c3d9-160">共有サービス、アプリケーション チーム、またはその両方を使用します。また、セキュリティ ポリシーとガバナンスも追跡します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-160">Use shared services, an application team, or both, and track security policies and governance as well.</span></span>

<span data-ttu-id="0c3d9-161">運用環境と開発/テスト環境を、Azure または Azure Stack Hub 上の別々のリソース グループにデプロイします。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-161">Deploy production environments and development/test environments in separate resource groups on Azure or Azure Stack Hub.</span></span> <span data-ttu-id="0c3d9-162">その後、各環境のリソースを監視し、リソース グループ別に課金コストをロール アップすることができます。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-162">Then you can monitor each environment's resources and roll up billing costs by resource group.</span></span> <span data-ttu-id="0c3d9-163">セットとしてリソースを削除することもできます。これはテスト デプロイの場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-163">You can also delete resources as a set, which is useful for test deployments.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="0c3d9-164">このパターンを使用する状況</span><span class="sxs-lookup"><span data-stu-id="0c3d9-164">When to use this pattern</span></span>

<span data-ttu-id="0c3d9-165">このパターンは次の状況で使用します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-165">Use this pattern if:</span></span>

- <span data-ttu-id="0c3d9-166">コードを、開発者のニーズを満たす環境で開発し、新しいコードの開発が困難な可能性があるソリューション固有の環境にデプロイできる場合。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-166">You can develop code in one environment that meets the needs of your developers, and deploy to an environment specific to your solution where it may be difficult to develop new code.</span></span>
- <span data-ttu-id="0c3d9-167">DevOps パターンの継続的インテグレーションと継続的デリバリーのプロセスに従うことができる限り、開発者が希望するコードとツールを使用できる場合。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-167">You can use the code and tools your developers would like, as long as they're able to follow the continuous integration and continuous delivery process in the DevOps Pattern.</span></span>

<span data-ttu-id="0c3d9-168">このパターンは次の場合は推奨されません。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-168">This pattern isn't recommended:</span></span>

- <span data-ttu-id="0c3d9-169">インフラストラクチャ、リソースのプロビジョニング、構成、ID、およびセキュリティ タスクを自動化できない場合。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-169">If you can't automate infrastructure, provisioning resources, configuration, identity, and security tasks.</span></span>
- <span data-ttu-id="0c3d9-170">チームで継続的インテグレーション/継続的開発 (CI/CD) アプローチを実装するためにハイブリッド クラウド リソースにアクセスできない場合。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-170">If teams don't have access to hybrid cloud resources to implement a Continuous Integration/Continuous Development (CI/CD) approach.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0c3d9-171">次のステップ</span><span class="sxs-lookup"><span data-stu-id="0c3d9-171">Next steps</span></span>

<span data-ttu-id="0c3d9-172">この記事で紹介したトピックの関連情報:</span><span class="sxs-lookup"><span data-stu-id="0c3d9-172">To learn more about topics introduced in this article:</span></span>

- <span data-ttu-id="0c3d9-173">Azure DevOps と関連ツール (Azure Repos、Azure Pipelines など) の詳細については、[Azure DevOps のドキュメント](/azure/devops)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-173">See the [Azure DevOps documentation](/azure/devops) to learn more about Azure DevOps and related tools, including Azure Repos, and Azure Pipelines.</span></span>
- <span data-ttu-id="0c3d9-174">製品とソリューションのポートフォリオ全体の詳細について、[Azure Stack ファミリの製品とソリューション](/azure-stack)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-174">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="0c3d9-175">ソリューションの例をテストする準備ができたら、[DevOps ハイブリッド CI/CD のソリューション デプロイ ガイド](https://aka.ms/hybriddevopsdeploy)に進んでください。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-175">When you're ready to test the solution example, continue with the [DevOps hybrid CI/CD solution deployment guide](https://aka.ms/hybriddevopsdeploy).</span></span> <span data-ttu-id="0c3d9-176">デプロイ ガイドでは、コンポーネントをデプロイしてテストするための詳細な手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-176">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span> <span data-ttu-id="0c3d9-177">ハイブリッドの継続的インテグレーション/継続的デリバリー (CI/CD) パイプラインを使用して Azure と Azure Stack Hub にアプリをデプロイする方法を学習します。</span><span class="sxs-lookup"><span data-stu-id="0c3d9-177">You learn how to deploy an app to Azure and Azure Stack Hub using a hybrid continuous integration/continuous delivery (CI/CD) pipeline.</span></span>
